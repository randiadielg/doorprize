{"version":3,"file":"static/js/658.1ec8a037.chunk.js","mappings":"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","sources":["constants/index.ts","hooks/useDoorprizeWebsocket.ts","hooks/useGet.ts","routes/Randomizer/Randomizer.tsx"],"sourcesContent":["export const SERVER_HOST = process.env.REACT_APP_SERVER_HOST || \"\";\nexport const DOORPRIZE_WS_HOST = process.env.REACT_APP_DOORPRIZE_WS_HOST || \"\";\n","import { useState, useEffect } from \"react\";\nimport { w3cwebsocket } from \"websocket\";\nimport { DOORPRIZE_WS_HOST } from \"../constants\";\n\nlet client = new w3cwebsocket(DOORPRIZE_WS_HOST);\n\ninterface UseDoorprizeWebsocketProps {\n  onStop?: () => void;\n  onGetNumber?: () => void;\n}\n\nconst useDoorprizeWebsocket = (props?: UseDoorprizeWebsocketProps) => {\n  const { onStop = () => {}, onGetNumber = () => {} } = props || {};\n  const [isRandomizing, setIsRandomizing] = useState(false);\n  const [number, setNumber] = useState<number>();\n  const [name, setName] = useState<string>(\"\");\n  const [isDisconnected, setIsDisconnected] = useState(true);\n\n  useEffect(() => {\n    client.onopen = () => {\n      setIsDisconnected(false);\n      console.log(\"WebSocket Client Connected\");\n    };\n    client.onmessage = (message) => {\n      const stringMessage = message.data.toString();\n      try {\n        if (stringMessage === \"stop\") {\n          setIsRandomizing(false);\n          onStop();\n        } else {\n          const { name, index } = JSON.parse(stringMessage);\n\n          setNumber(parseInt(index));\n          setName(name);\n          setIsRandomizing(true);\n          onGetNumber();\n        }\n      } catch (err) {\n        console.error(err);\n      }\n    };\n    client.onclose = () => {\n      setIsDisconnected(true);\n    };\n\n    client.onerror = (err) => {\n      console.error(\n        \"Socket encountered error: \",\n        err.message,\n        \"Closing socket\"\n      );\n      client.close();\n    };\n  }, [onStop, onGetNumber]);\n\n  return { isRandomizing, number, name, isDisconnected };\n};\n\nexport default useDoorprizeWebsocket;\n","import axios, { AxiosResponse } from \"axios\";\nimport { useState, useEffect, useCallback } from \"react\";\n\nconst useGet = (url: string) => {\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const [data, setData] = useState<AxiosResponse | null>(null);\n  const loadData = useCallback(async () => {\n    try {\n      setLoading(true);\n      const actionData = await axios.get(url);\n      setData(actionData);\n    } catch (e: any) {\n      setError(e);\n    } finally {\n      setLoading(false);\n    }\n  }, [url]);\n  useEffect(() => {\n    loadData();\n  }, [loadData]);\n  return { data: data?.data, loading, error, refetch: loadData };\n};\n\nexport default useGet;\n","import { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { SERVER_HOST } from \"../../constants\";\nimport { Typography } from \"antd\";\nimport useDoorprizeWebsocket from \"../../hooks/useDoorprizeWebsocket\";\nimport useGet from \"../../hooks/useGet\";\n\nconst RandomizerView = () => {\n  const { number, isRandomizing, isDisconnected } = useDoorprizeWebsocket();\n  const [maxNumber, setMaxNumber] = useState(150);\n  const [dummyRandom, setDummyRandom] = useState<string>();\n  const { data: items } = useGet(`${SERVER_HOST}/items`);\n\n  const fetchMax = async () => {\n    const res = await axios.get(`${SERVER_HOST}/max`);\n    setMaxNumber(res.data);\n  };\n\n  useEffect(() => {\n    fetchMax();\n  }, []);\n\n  useEffect(() => {\n    let interval: ReturnType<typeof setInterval>;\n    if (isRandomizing) {\n      interval = setInterval(() => {\n        setDummyRandom(Math.round(Math.random() * maxNumber).toString());\n      }, 10);\n    }\n\n    return () => {\n      clearInterval(interval);\n    };\n  }, [maxNumber, isRandomizing]);\n\n  if (isRandomizing) {\n    return (\n      <div style={{ display: \"flex\", justifyContent: \"center\" }}>\n        {dummyRandom && (\n          <Typography.Title\n            style={{ margin: 0, fontSize: \"200px\", color: \"#FFA100\" }}\n          >\n            {items[dummyRandom]}\n          </Typography.Title>\n        )}\n      </div>\n    );\n  }\n  return (\n    <div style={{ display: \"flex\", justifyContent: \"center\" }}>\n      {number && (\n        <Typography.Title\n          style={{ margin: 0, fontSize: \"200px\", color: \"#FFA100\" }}\n        >\n          {isDisconnected && \"Error\"}\n          {items[number]}\n        </Typography.Title>\n      )}\n    </div>\n  );\n};\n\nexport default RandomizerView;\n"],"names":["SERVER_HOST","process","DOORPRIZE_WS_HOST","client","w3cwebsocket","props","onStop","onGetNumber","useState","isRandomizing","setIsRandomizing","number","setNumber","name","setName","isDisconnected","setIsDisconnected","useEffect","onopen","console","log","onmessage","message","stringMessage","data","toString","JSON","parse","index","parseInt","err","error","onclose","onerror","close","url","loading","setLoading","setError","setData","loadData","useCallback","axios","actionData","refetch","useDoorprizeWebsocket","maxNumber","setMaxNumber","dummyRandom","setDummyRandom","items","useGet","fetchMax","res","interval","setInterval","Math","round","random","clearInterval","style","display","justifyContent","margin","fontSize","color"],"sourceRoot":""}